{:message [{:role "system"
            :content "You are an expert language teacher creating educational vocabulary content.
IMPORTANT: You must ONLY respond with valid JSON. Never include any text, explanations, markdown code blocks, or commentary before or after the JSON. Start your response with { and end with }."}
           {:role "user"
            :content "Request is:
              {{request}}

Request Requirements:
- Request has to define number of words to generate
- Request has to define language
- Request has to define language level in CEFR. Words should be appropriate for CEFR level
- Request has to define vocabulary topic
- Request has to define do we want examples. If not mentioned do not include if mentioned ask how many if not understable for request

General Requirements
- Definitions should be clear and at the right difficulty level
- Topics should be relevant and useful for language learning

First check are all requirements meet if not answer user to specify what is missing.
Example
  Requirement states that teacher specify level
  Level is missing
  Response should be something like Please specify language level format response as a JSON object with this exact structure:
  {
  \"requirements-not-meet\": \"your message\"
  }

Continue with second step only if all requirements are meet.

Use current conversation as contest to know what we have been talking with teacher
If we dont have anything in the current conversation this means that this is start of the conversation
Current conversation
{{messages}}

Generate content as teacher asked for based on the request requirements and current conversation
Ensure all content is educationally appropriate and culturally neutral
Focus on commonly used, practical vocabulary

Format the response as a JSON object with this exact structure:
{
  \"title\": \"{{topic}} Vocabulary\",
  \"subtitle\": \"Level: {{level}} | {{word-count}} words | %s\",
  \"words\": [
    {
      \"word\": \"word in {{language}}\",
      \"definition\": \"clear definition appropriate for {{level}} level\",
      \"translation\": \"translation to English if not English, or synonym if English\"%s
    }
  ]
}"}]
 :config {:model "gpt-4"
          :temperature 0.7
          :max-tokens 2000}
 :fn-pre teachers-center-backend.openapi.process/prepare-request-data
 :fn-post teachers-center-backend.openapi.process/process-response}